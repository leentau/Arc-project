一、	前言
在人类的生活环境中，温湿度扮演着极其重要的角色。自18世纪工业革命以来，工业发展与是否能够掌握温湿度有着密切的联系。在冶金、钢铁、石化、水泥、玻璃、医药等行业，可以说几乎80%的工业部门不得不考虑温湿度的因素。温室大棚技术就是一个很好的方法。温室大棚就是建立一个模拟适合生物生长的气候条件，创造一个人工气象环境，来消除温度对生物生长的约束。而且，温室大棚能克服环境对生物生长的限制，能使不同的农作物在不适合生长的季节产出，使季节对农作物的生长不再产生过度影响，大大减少了农作物对自然条件的依赖。由于温室大棚能带来可观的经济效益，所以温室大棚技术越来越普及，并且已成为农民增收的主要手段。
应用自动控制和电子计算机实现农业生产和管理的自动化，是农业现代化的重要标志之一，近年来电子技术和信息技术的飞速发展，带来了温室控制与管理技术方面的一场革命，在农业生产，园艺生产，动植物养殖等方面有着广泛的运用，对于农业生产的增产增量，可产生巨大的经济效益与社会效应。
温室大棚智能控制系统是一种智能化管理大棚的科学系统，这种系统需要相应的感应设备来保证系统的正常运行，智能控制系统是将信息技术运用到农业的体现，通过系统设定的各种指令，自动化的完成管理工作，无需大量的人工操作，是一种现代化农业发展的必要工具。
二、	总体方案设计
设计方案分两个阶段，第一阶段为数据检测功能的实现，第二阶段为环境调整功能的实现。
1.	第一阶段：数据检测功能
a)	温湿度采集模块
大棚的温湿度随着时间的早晚呈现不同的分布，通过计算机编写程序控制处理器的工作，同理，温湿度传感器检测空气的温湿度。这样，我们就能实时掌握大棚的温湿度信息并采取合理的措施来控制使其适宜我们的舒适要求，所有传感器的检测结果会在显示器上实时显示。温湿度传感器检测的信号，由ARC EM Starter Kit开发板将需要信号转换为需要的电流值并显示在LED显示屏上。温度、湿度等各节点由ARC-EMSK开发板通过Pmod转换器外接各对应传感器构成， ARC-EMSK通过I2C接口读取实时的室内温度湿度值，当温湿度大于一定值时，继电器开关打开 ，LED显示。当温湿度值小于一定值时，继电器开关关闭，从而温湿度测试持续工作。当电流的大小增加到所需要的大时，继电器开始关闭-开启循环操作，维持电流值在所需电流一定范围内。
b)	温度控制模块
大棚温度由温湿度传感器检测，并由ARC EM Starter Kit开发板将需要变温信号转换为需要的电流值控制风扇运转。电流值大于一定值时，继电器开关打开，从而导致风扇停止工作。电流值小于一定值时 ,继电器开关关闭，从而导致风扇持续工作。当电流的大小增加到所需要的大时,继电器开始关闭—开启循环操作，维持电流值在所需电流一定范围内。
 
c)	湿度控制模块
超声雾化加湿器把普通自来水变成蒸气散布在需要加湿的空间里，使相对湿度达到预期的水平。所需的加湿量由温湿度传感器检测，并由ARC EM Starter Kit开发板将需要加湿量信号转换为需要的电流值。需要的加湿量大于一定值时，继电器开关打开，从而导致加湿器停止工作。需要的加湿量小于一定值时 ,继电器开关关闭，从而导致加湿器持续工作。当电流的大小增加到所需要的大时 ,继电器开始关闭—开启循环操作，维持电流值在所需电流一定范围内。当检测空气中增加的湿度时 ,蒸汽输出停止，不断循环。

2.	第二阶段：扩展功能升级
在实现大棚温湿度控制的基础上，为提高使用的便捷性，进一步完善功能，提升使用感受，增加蓝牙模块，通过手机终端无线控制智能控制系统，实现使用手机App直接设置大棚的温湿度以及工作时间。

三、	硬件模块设计与原理分析
1.	显示器模块
通过外设键盘用户可以自主设置温度，具体温度实时显示在OLED显示屏上。本次设计选用的型号为OLED 12864，有机发光OLED是比液晶显示技术更为先进的新一代平板显示技术，具有超轻薄、高亮度、广视角、自发光、响应速度快、适应温度范围宽、功耗低、可实现柔软显示等优越性。此液晶显示器为0.96寸OLED显示屏以及IIC接口，OLED，即有机发光二极管(organic light emitting diode)。0.69寸OLED有黄、白、蓝三种颜色可选，其中黄蓝为屏上1/4为黄光，下面的3/4为蓝光，而且固定区域显示固定颜色，颜色和显示区域均不能更改。白光则为纯白，即黑底白字；蓝色为纯蓝，即黑底蓝字。分辨率为128*64。有五种接口方式：6800、8080两种并行接口方式、3线或者4线的串行SPI接口方式、iic接口方式(只需要2根线就可以控制OLED)，这五种接口是通过屏上的BS0-BS2来控制的。。
2.	蓝牙模块
蓝牙模块本次设计选用的型号为HM-10，HM-10系列蓝牙模块采用TIcc2540芯片，配置256Kb空间，支持TA指令，用户可根据需要更改角色以及串口波特率，设备名称，配对密码等参数，使用灵活。
3.	温湿度采集模块
在工程应用中，温度量的采集通常采用两种方式将温度的变化转换成电信号的变化，一种是热电偶，就是随着温度的变化，在热电偶的输出端有一个电压随着温度的变化而变化，将这个电压进行放大，就可以进行显示或者去控制相应的自动设备。另一种是热电阻，利用电阻的材料的温度特性，既测温元件随着测量温度的变化电阻值也在变化，利用电阻的变化特性，控制放大电路，就可以得到一个温度信号，驱动仪表显示或者去控制自动装置。但是热电阻与热电偶都有其缺点，比如非线性、冷补偿、测量范围小等等。为避免这些缺点带来的采集结果不精确，本次设计选用AM2302数字温湿度传感器。
AM2302数字温湿度传感器是一款含有已校准数字信号输出的温湿度复合传感器。它应用专用的数字模块采集技术和温湿度传感技术，确保产品具有极高的可靠性与卓越的长期稳定性。传感器包括一个电容式感湿元件和一个NTC测温元件，并与一个高性能8位单片机相连接。因此该产品具有品质卓越、超快响应、抗干扰能力强、性价比极高等优点。每个AM2302传感器都在极为精确的湿度校验室中进行校准。校准系数以程序的形式储存在OTP内存中，传感器内部在检测信号的处理过程中要调用这些校准系数。单线制串行接口，使系统集成变得简易快捷。超小的体积、极低的功耗，信号传输距离可达20米以上，使其成为各类应用甚至最为苛刻的应用场合的最佳选则。产品为4针单排引脚封装。连接方便，特殊封装形式可根据用户需求而提供。
4.	温湿度控制系统
超声雾化器的工作电流由继电器控制，继电器接收到ARC EM Starter Kit FPGA开发板发出的工作指令，便会接通小电流，螺线管通电，从而给超声雾化器提供大电流使它可以正常工作；反之，继电器收到ARC EM Starter Kit FPGA开发板发出的停止工作指令，便会断开小电流，螺线管不通电，超声雾化器得不到大电流，便停止工作
风扇的工作电流由继电器控制，继电器接收到ARC EM Starter Kit FPGA开发板发出的工作指令，便会接通小电流，螺线管通电，从而给风扇提供大电流使它可以正常工作；反之，继电器收到ARC EM Starter Kit FPGA开发板发出的停止工作指令，便会断开小电流，螺线管不通电，风扇得不到大电流，便停止工作。
四、	系统软件设计
系统上电启动后，首先进行系统的初始化，基于ARC的控制器上电后进入主程序，对I/O口、定时器、串行口等进行初始化。经过初始化，系统各部分准备就绪，可以进行工作。首先进行温湿度测量，实时显示温湿度，然后由按键输入设定温湿度，温湿度设定完毕后，程序启动温湿度比较，当设定的温湿度大于实时温湿度，开始升温湿调节，当设定的温湿度小于实时温湿度时，开始降温湿调节。由于来自外界的干扰不断产生，想要达到现场控制目标的恒定，控制作用就必须不断进行。通过比对实时温度与设定温度，将偏差送入数字PID控制器的输入端，PID控制器按照偏差值以预先设定好的整定参数控制控制规律发出控制信号，通过调节PWM占空比来调节TEC的温度从而使被控对象趋于设定。
五、	小结
在总体设计中，我们以ARC EM Starter Kit FPGA开发板为主要核心，加上温湿度传感设备和显示设备，基本构成温湿度监测系统，之后采用雾化器以及风扇构成温湿度调控系统。主体确定后，选择器件便成为很重要的一步，我查阅相关器件的一些资料，比如温湿度传感器、显示屏、继电器等等，将不同型号的器件特性做了对比，最终确定将ARC EM Starter Kit FPGA开发板、AM2302温湿度传感器作为主要器件，继电器和一些电容电阻等基本器件，完成方案设计。
